version: '{build}'

os: Windows Server 2012 R2

environment:
  APP_NAME: 'marioBadClone'
  UNITY_HOME: 'C:\Applications\Unity'
  UNITY_BIN_DIR: 'C:\Applications\Unity\Editor'

platform:
  - x86

install:
  - ps: |
      Write-Output "Current directory is $(Get-Location)"
      if ( -Not ( Test-Path "C:\unity.download.4.6.9" ) ) {
        New-Item -ItemType directory -Path C:\unity.download.4.6.9

        $url = "http://beta.unity3d.com/download/7083239589/UnitySetup-4.6.9.exe"
        $output = "C:\unity.download.4.6.9\UnitySetup-4.6.9.exe"
        $start_time = Get-Date

        Write-Output "Downloading..."
        $wc = New-Object System.Net.WebClient
        $wc.DownloadFile($url, $output)
        #Import-Module -Name BitsTransfer -Verbose
        #Start-BitsTransfer -Source $url -Destination $output

        Write-Output "Downloaded in: $((Get-Date).Subtract($start_time).Seconds) second(s)"
      }
      if ( -Not ( Test-Path "C:\Applications\Unity" ) ) {
        Write-Output "Installing..."
        Start-Process -FilePath ci_scripts\install.bat -ArgumentList ($output,$UNITY_HOME) -Wait -NoNewWindow -Debug
        Write-Output "Finished installation step"
      }

build_script:
  - cmd: call ci_scripts\build.bat

test_script:
  - ps: |
      Write-Output "No test scripts"

cache:
  - C:\unity.download.4.6.9
  - C:\Applications\Unity4.6.9

notifications:
  email: false
